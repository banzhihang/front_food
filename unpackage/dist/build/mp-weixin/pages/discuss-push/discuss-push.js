(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/discuss-push/discuss-push"],{1253:function(t,e,n){},"56f8":function(t,e,n){"use strict";var u=n("1253"),r=n.n(u);r.a},"735f":function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return u}));var u={uToast:function(){return n.e("uview-ui/components/u-toast/u-toast").then(n.bind(null,"3126"))},uNavbar:function(){return n.e("uview-ui/components/u-navbar/u-navbar").then(n.bind(null,"ec29"))},uButton:function(){return n.e("uview-ui/components/u-button/u-button").then(n.bind(null,"24c4"))},uInput:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-input/u-input")]).then(n.bind(null,"b7ef"))},uLine:function(){return n.e("uview-ui/components/u-line/u-line").then(n.bind(null,"1d42"))},uUpload:function(){return n.e("uview-ui/components/u-upload/u-upload").then(n.bind(null,"cbe6"))},uPopup:function(){return n.e("uview-ui/components/u-popup/u-popup").then(n.bind(null,"55b4"))},uAlertTips:function(){return n.e("uview-ui/components/u-alert-tips/u-alert-tips").then(n.bind(null,"e03d"))}},r=function(){var t=this,e=t.$createElement;t._self._c},o=[]},"87e7":function(t,e,n){"use strict";(function(t){n("1111");u(n("66fd"));var e=u(n("aa6f"));function u(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"8b31":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var u=c(n("a34a")),r=c(n("8164")),o=n("541f"),i=n("5d11"),a=n("4018"),s=n("db06");function c(t){return t&&t.__esModule?t:{default:t}}function f(t,e,n,u,r,o,i){try{var a=t[o](i),s=a.value}catch(c){return void n(c)}a.done?e(s):Promise.resolve(s).then(u,r)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(u,r){var o=t.apply(e,n);function i(t){f(o,u,r,i,a,"next",t)}function a(t){f(o,u,r,i,a,"throw",t)}i(void 0)}))}}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var p={data:function(){return{customStyle1:d({borderColor:"#f3eff6",backgroundColor:"#3363D1",height:"120rpx",width:"120rpx"},"height","50rpx"),navCustomStyle:{color:"#000000",fontSize:"33rpx"},discussTitle:"",content:"",titleCustomStyle:{fontSize:"38rpx"},contentStyle:{fontSize:"32rpx"},food:-1,showError:!1,errInfo:[],imageList:[],errDict:{title:"讨论标题",content:"讨论内容",image:"讨论配图"},action:"https://up-z2.qiniup.com",formData:{token:""}}},methods:{closeError:function(){this.errInfo=[]},submitDiscuss:function(){var t=this;return l(u.default.mark((function e(){var n,o,a,c,f,l;return u.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=(0,s.checkLogin)(),n){e.next=3;break}return e.abrupt("return");case 3:o=t.$refs.uUpload.lists.filter((function(t){return 100==t.progress})),o.forEach((function(e){var n=i.photoDomain+e.response.key;t.imageList.push(n)})),a={food:t.food,title:t.discussTitle.replace(/\s+/g,""),content:t.content,image:t.imageList},c={title:{title:"string",max:10,min:2,required:!0,message:"标题最少两个字"},content:{type:"string",max:200,min:4,required:!1,message:"内容最少四个字"},image:{type:"array",max:5,min:0,required:!1,message:"最多5张照片"}},f=new r.default(c),l=t,f.validate(a,(function(e,n){if(e){for(var u in e){var r={name:l.errDict[e[u].field],value:e[u].message};l.errInfo.push(r)}return l.showError=!0,void(l.imageList=[])}t.subPostData(a)}));case 10:case"end":return e.stop()}}),e)})))()},subPostData:function(e){var n=this;return l(u.default.mark((function r(){var o,s,c;return u.default.wrap((function(u){while(1)switch(u.prev=u.next){case 0:return t.showLoading({title:"发布中",mask:!0}),o=i.discussPushDomain,s=(0,a.encrypt)(e),u.next=5,n.$http.post(o,s);case 5:c=u.sent,c.data,t.hideLoading(),t.showToast({title:"已提交审核",success:function(){setTimeout((function(){t.navigateBack({})}),1500)}});case 9:case"end":return u.stop()}}),r)})))()},chooseReady:function(t){var e=this;return l(u.default.mark((function t(){var n;return u.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,o.getUploadToken)();case 2:n=t.sent,e.formData.token=n,setTimeout((function(){e.$refs.uUpload.upload()}),500);case 5:case"end":return t.stop()}}),t)})))()}},onLoad:function(t){var e=JSON.parse(decodeURIComponent(t.item));this.food=e.food,(0,s.checkLogin)()}};e.default=p}).call(this,n("543d")["default"])},a600:function(t,e,n){"use strict";n.r(e);var u=n("8b31"),r=n.n(u);for(var o in u)"default"!==o&&function(t){n.d(e,t,(function(){return u[t]}))}(o);e["default"]=r.a},aa6f:function(t,e,n){"use strict";n.r(e);var u=n("735f"),r=n("a600");for(var o in r)"default"!==o&&function(t){n.d(e,t,(function(){return r[t]}))}(o);n("56f8");var i,a=n("f0c5"),s=Object(a["a"])(r["default"],u["b"],u["c"],!1,null,"06e76a7b",null,!1,u["a"],i);e["default"]=s.exports}},[["87e7","common/runtime","common/vendor"]]]);