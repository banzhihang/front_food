(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/self/login"],{1300:function(n,t,e){"use strict";e.r(t);var o=e("53c7"),r=e.n(o);for(var u in o)"default"!==u&&function(n){e.d(t,n,(function(){return o[n]}))}(u);t["default"]=r.a},"1a74":function(n,t,e){"use strict";(function(n){e("1111");o(e("66fd"));var t=o(e("9ffc"));function o(n){return n&&n.__esModule?n:{default:n}}n(t.default)}).call(this,e("543d")["createPage"])},"201c":function(n,t,e){"use strict";e.d(t,"b",(function(){return r})),e.d(t,"c",(function(){return u})),e.d(t,"a",(function(){return o}));var o={uAvatar:function(){return e.e("uview-ui/components/u-avatar/u-avatar").then(e.bind(null,"df23"))},uButton:function(){return e.e("uview-ui/components/u-button/u-button").then(e.bind(null,"24c4"))}},r=function(){var n=this,t=n.$createElement;n._self._c},u=[]},"4ad8":function(n,t,e){"use strict";var o=e("7853"),r=e.n(o);r.a},"53c7":function(n,t,e){"use strict";(function(n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=u(e("a34a")),r=e("4018");function u(n){return n&&n.__esModule?n:{default:n}}function a(n,t,e,o,r,u,a){try{var i=n[u](a),c=i.value}catch(s){return void e(s)}i.done?t(c):Promise.resolve(c).then(o,r)}function i(n){return function(){var t=this,e=arguments;return new Promise((function(o,r){var u=n.apply(t,e);function i(n){a(u,o,r,i,c,"next",n)}function c(n){a(u,o,r,i,c,"throw",n)}i(void 0)}))}}var c={data:function(){return{customStyle:{height:"80rpx",width:"430rpx",backgroundColor:"#1a5abf",color:"#FFFFFF",fontSize:"30rpx"},btnLoading:!1,userInfo:{},code:"",loginText:"登录"}},methods:{login:function(){var t=this;return i(o.default.mark((function e(){var r;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.btnOnLoading(),r=t,e.next=4,n.login({provider:"weixin",success:function(n){r.code=n.code},fail:function(){n.showToast({title:"登录失败",icon:"error"}),r.btnLoaded()}});case 4:return e.next=6,n.getUserProfile({desc:"获取你的头像及昵称",success:function(n){r.userInfo=n.userInfo,r.loginMyService()},fail:function(){n.showToast({title:"登录失败",icon:"error"}),r.btnLoaded()}});case 6:case"end":return e.stop()}}),e)})))()},loginMyService:function(){var t=this;return i(o.default.mark((function e(){var u,a,i,c,s;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return u=t,a={code:u.code,nickName:u.userInfo.nickName,avatarUrl:u.userInfo.avatarUrl,source:"wx"},i=(0,r.encrypt)(a),e.next=5,u.$http.post("/login",i);case 5:c=e.sent,s=c.data,n.setStorage({key:"loginToken",data:s.data.token,success:function(){var t=n.getStorageSync("loginToken");console.log(t),t&&(u.btnLoaded(),n.showToast({title:"登录成功",icon:"success"}),n.navigateBack())}});case 8:case"end":return e.stop()}}),e)})))()},btnOnLoading:function(){this.btnLoading=!0,this.loginText="登录中..."},btnLoaded:function(){this.btnLoading=!1,this.loginText="登录"}}};t.default=c}).call(this,e("543d")["default"])},7853:function(n,t,e){},"9ffc":function(n,t,e){"use strict";e.r(t);var o=e("201c"),r=e("1300");for(var u in r)"default"!==u&&function(n){e.d(t,n,(function(){return r[n]}))}(u);e("4ad8");var a,i=e("f0c5"),c=Object(i["a"])(r["default"],o["b"],o["c"],!1,null,"7e289608",null,!1,o["a"],a);t["default"]=c.exports}},[["1a74","common/runtime","common/vendor"]]]);